<!DOCTYPE html>
<html>
  <head>
    <title>Place details</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #map {
        height: 100%;
      }
    </style>
    
    
    
     <div id="page-wrapper">

        <h3>Text File Reader</h3>
        <div>
            Select a text file: 
            <input type="file" id="fileInput">
        </div>

    </div>
    
    
    
    <!-- JS part -->
<script>

   var atlanta = { lat: 33.7550, lng: -84.3900 };
   var atlanta2 = { lat: 33.80, lng: -84.400 };
   
    	var map ;
	
function initMap() {
	
	 map = new google.maps.Map(document.getElementById('map'), {
    					zoom: 10,
   					 	center: atlanta
				});
/*
   var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 10,
    center: atlanta
  });
  var merchants = [atlanta, atlanta2];
  

  for (var i = 0; i < merchants.length; i++){
    addMarker(merchants[i], map, '<h2>' + 'testing' + '</h2>' + '<p>' + 'hi');
  }
*/
}







window.onload = function () {
	   
		var fileInput = document.getElementById('fileInput');
		//var fileDisplayArea = document.getElementById('fileDisplayArea');

		fileInput.addEventListener('change', function(e) {
			var file = fileInput.files[0];
			var textType = /text.*/;
			var reader = new FileReader();

			if (file.type.match(textType)) {
				
				reader.onload = function(e) {
        			callback(reader.result);
				}		
	
  				reader.readAsText(file);
				
			} else {
				fileDisplayArea.innerText = "File not supported!"
			}		
			
		});
		
		
 
		
  }
  
  function callback(data) {
	//object
	var car = {type:"Fiat", model:500, color:"white"};

	
// 	var merchants = [atlanta, atlanta];
	var merchants = [];
	var lines = data.split('\n');
	
	
	
	for (var i = 0; i < lines.length-5; i++){
	var words = lines[i].split('\" \"');
	
	//remove the first double quotation mark
    	words[0] = words[0].substr(1);
				
		var merchant = {		
			name: words[0],
			id: words[1],
			address: words[2] + ', ' + words[3],
			lat: parseFloat(words[4]), 
			lng: parseFloat(words[5])
		};
		merchants.push(merchant);
	}
	
	for (var i = 0; i < merchants.length ; i++){
	console.log(merchants[i]);
	}
		

 		for (var i = 0; i < merchants.length; i++){
		var coordinate = {lat: merchants[i].lat, lng: merchants[i].lng};
		var str = '<h3>' + merchants[i].name + '</h3>'+ '<br>' + merchants[i].address;
 		  addMarker(coordinate, map, str);
		}
	   

		return data;
  }
  
  
  // Adds a marker to the map.
function addMarker(location, map, contentString) {


  var marker = new google.maps.Marker({
    position: location,
    map: map
  });
  
  
  // info window
      var infowindow = new google.maps.InfoWindow({
    content: contentString,
    maxWidth: 200
  });
  
    marker.addListener('click', function() {
    infowindow.open(map, marker);
  });
}

</script>

    
    
    
    
  </head>
  
  
  
  
  
  <body>
    <div id="map"></div>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDlcXnQW9Qg4smqSPdWiKB4oBuREUO2juA&signed_in=true&libraries=places&callback=initMap" async defer></script>
  </body>
  
  
  
</html>


